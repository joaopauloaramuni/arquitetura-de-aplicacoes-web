<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>YouTube Video Downloader</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const form = document.getElementById("videoForm");

            form.addEventListener("submit", function(event) {
                event.preventDefault(); // Impede o redirecionamento do formulário

                const url = document.getElementById("url").value; // Captura a URL do campo

                alert("Download iniciado!"); // Alerta de início de download

                // Fazendo uma requisição AJAX para o endpoint de download
                fetch("/download", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded",
                    },
                    body: new URLSearchParams({ "url": url }), // Enviando a URL
                })
                    .then(response => {
                        if (response.ok) {
                            return response.text(); // Retorna o texto da resposta
                        }
                        throw new Error('Erro na requisição');
                    })
                    .then(data => {
                        console.log(data); // Para depuração
                        alert("Download concluído!"); // Alerta de conclusão de download
                    })
                    .catch(error => {
                        alert("Erro ao iniciar o download: " + error.message); // Mensagem de erro
                    });
            });
        });
    </script>
</head>
<body>
<div class="container">
    <h2>Download de Vídeo do YouTube</h2>

    <form id="videoForm">
        <div class="input-group">
            <label for="url">URL do Vídeo:</label>
            <input type="text" id="url" name="url" placeholder="Cole a URL do vídeo aqui" required>
        </div>

        <button type="submit" class="btn-download">Download</button>
    </form>
</div>
</body>
</html>
